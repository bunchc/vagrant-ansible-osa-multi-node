---
## Load balancers for ELK and TIGK/TICK
- name: lb-01
  ansible_groups:
    - elkstack
    - loadbalancers
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.11
      auto_config: true
      method: static
  mem: 512
  provision: true
  vcpu: 1
  windows: false
- name: lb-02
  ansible_groups:
    - elkstack
    - loadbalancers
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.12
      auto_config: true
      method: static
  mem: 512
  provision: true
  vcpu: 1
  windows: false

## Beginning of ELKStack nodes
##
## Brokers are either redis or rabbitmq
## Currently redis works best, as a single node
- name: broker-01
  ansible_groups:
    - brokers
    - elkstack
    - redis
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.21
      auto_config: true
      method: static
  mem: 512
  provision: true
  vcpu: 1
  windows: false
#- name: broker-02
#  ansible_groups:
#    - brokers
#    - elkstack
#    - redis
#  box: bunchc/ubuntu-16.04-libvirt
#  desktop: false
#  provider: libvirt
#  interfaces:
#    - ip: 192.168.250.22
#      auto_config: true
#      method: static
#  mem: 512
#  provision: true
#  vcpu: 1
#  windows: false

## Logstash nodes
## This is where the loadbalancer sends all incoming logs
- name: pre-processor-01
  ansible_groups:
    - elkstack
    - pre_processors
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.31
      auto_config: true
      method: static
  mem: 1024
  provision: true
  vcpu: 1
  windows: false

## Processor nodes
## Transformation magic happens here
- name: processor-01
  ansible_groups:
    - elkstack
    - processors
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.41
      auto_config: true
      method: static
  mem: 1024
  provision: true
  vcpu: 1
  windows: false

## Elastic search cluster
- name: es-01
  ansible_groups:
    - elasticsearch
    - elkstack
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.51
      auto_config: true
      method: static
  mem: 1024
  provision: true
  vcpu: 1
  windows: false
- name: es-02
  ansible_groups:
    - elasticsearch
    - elkstack
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.52
      auto_config: true
      method: static
  mem: 1024
  provision: true
  vcpu: 1
  windows: false
- name: es-03
  ansible_groups:
    - elasticsearch
    - elkstack
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.53
      auto_config: true
      method: static
  mem: 1024
  provision: true
  vcpu: 1
  windows: false

## Dashboard nodes
## Kibana and graphana run here
- name: dashboard-01
  ansible_groups:
    - dashboard
    - stats
    - elkstack
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.61
      auto_config: true
      method: static
  mem: 1024
  provision: true
  vcpu: 1
  windows: false

## InfluxDB "cluster"
- name: influx-relay-01
  ansible_groups:
    - elkstack
    - influx_relay
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.94
      auto_config: true
      method: static
  mem: 512
  provision: true
  vcpu: 1
  windows: false
- name: influx-relay-02
  ansible_groups:
    - elkstack
    - influx_relay
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.95
      auto_config: true
      method: static
  mem: 512
  provision: true
  vcpu: 1
  windows: false
- name: influxdb-01
  ansible_groups:
    - elkstack
    - influx
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.91
      auto_config: true
      method: static
  mem: 512
  provision: true
  vcpu: 1
  windows: false
- name: influxdb-02
  ansible_groups:
    - elkstack
    - influx
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.92
      auto_config: true
      method: static
  mem: 512
  provision: true
  vcpu: 1
  windows: false

# OpenStack Ansible All-in one node
# Spins up an openstack AIO of a given release
# and ties it into the monitoring stack
- name: openstack-ansible-01
  ansible_groups:
    - elkstack
    - openstack
  box: bunchc/ubuntu-16.04-libvirt
  desktop: false
  provider: libvirt
  interfaces:
    - ip: 192.168.250.71
      auto_config: true
      method: static
  mem: 12288
  provision: true
  vcpu: 4
  windows: false
